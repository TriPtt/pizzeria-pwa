name: Debug Pipeline

on:
  push:
  pull_request:

jobs:
  debug:
    name: Debug Info
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup Node.js 20
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Check secrets (safely)
        run: |
          echo "ğŸ” Checking secrets availability..."
          if [ -z "$JWT_SECRET" ]; then
            echo "âŒ JWT_SECRET is not set"
          else
            echo "âœ… JWT_SECRET is available (length: ${#JWT_SECRET})"
          fi
          
          if [ -z "$DATABASE_URL" ]; then
            echo "âŒ DATABASE_URL is not set"
          else
            echo "âœ… DATABASE_URL is available"
          fi
        env:
          JWT_SECRET: ${{ secrets.JWT_SECRET }}
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
      
      - name: Check project structure
        run: |
          echo "ğŸ“ Project structure:"
          ls -la
          echo ""
          echo "ğŸ“ Back folder:"
          ls -la back/ || echo "âŒ No back folder"
          echo ""
          echo "ğŸ“ Front folder:"  
          ls -la front/ || echo "âŒ No front folder"
      
      - name: Test backend basic
        run: |
          echo "ğŸ” Testing backend..."
          if [ -d "back" ] && [ -f "back/package.json" ]; then
            cd back
            echo "ğŸ“¦ Backend package.json found"
            echo "Installing dependencies..."
            npm ci
            echo "âœ… Backend dependencies OK"
          else
            echo "âŒ Backend setup issue"
          fi
      
      - name: Test frontend basic  
        run: |
          echo "ğŸ” Testing frontend..."
          if [ -d "front" ] && [ -f "front/package.json" ]; then
            cd front
            echo "ğŸ“¦ Frontend package.json found"
            echo "Installing dependencies..."
            npm ci
            echo "Building..."
            npm run build
            echo "âœ… Frontend build OK"
          else
            echo "âŒ Frontend setup issue"
          fi
